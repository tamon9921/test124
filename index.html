<!DOCTYPE html>
<html lang="ja">
<head>
    <title>WebGL|3D画像</title>
    <meta name="description" content="sekigamiが公開テスト中の作成資料です。">
    <meta charset="utf-8">
    <meta name="generator" content="Three.js Editor">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
        body {
            font-family: sans-serif;
            font-size: 11px;
            background-color: #000;
            margin: 0px;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body ontouchstart="">
    <script type="module">

    import * as THREE from './js/three.module.js';
    import { APP } from './js/app.js';

    window.THREE = THREE; // Used by APP Scripts.

    var loader = new THREE.FileLoader();
    loader.load( 'app.json', function ( text ) {

        var player = new APP.Player();
        player.load( JSON.parse( text ) );
        player.setSize( window.innerWidth, window.innerHeight );
        player.play();

        // アニメーションの自動再生設定
        player.mixer = new THREE.AnimationMixer( player.scene );

        // シーン内のオブジェクトのアニメーションを再生する
        player.scene.traverse( function ( object ) {
            if ( object.animations && object.animations.length > 0 ) {
                var action = player.mixer.clipAction( object.animations[0], object );
                action.play();
            }
        });

        document.body.appendChild( player.dom );

        window.addEventListener( 'resize', function () {
            player.setSize( window.innerWidth, window.innerHeight );
        } );

        // アニメーションの更新
        var clock = new THREE.Clock();
        function animate() {
            requestAnimationFrame( animate );
            var delta = clock.getDelta();
            if (player.mixer) player.mixer.update(delta);
        }
        animate();

    } );

    </script>


</body>
</html>
